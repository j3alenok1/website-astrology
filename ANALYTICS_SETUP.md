# Настройка Яндекс.Метрики и Google Analytics

Компоненты уже подключены в проекте. Осталось получить ID и добавить их в переменные окружения.

---

## 1. Яндекс.Метрика

### Шаг 1: Создание счётчика

1. Перейдите на [metrika.yandex.ru](https://metrika.yandex.ru)
2. Войдите через Яндекс ID
3. Нажмите **«Добавить счётчик»**
4. Укажите:
   - **Название:** ASTRO by NDAUZH
   - **Сайт:** `https://astrobyndauzh.com` (или ваш домен)
   - **Часовой пояс:** Алматы (UTC+5)
5. Примите условия и нажмите **«Создать счётчик»**

### Шаг 2: Получение ID

После создания счётчика вы увидите **числовой ID** (например, `98765432`). Скопируйте его.

### Шаг 3: Добавление в проект

**Локально** — в файл `.env.local`:
```
NEXT_PUBLIC_YANDEX_METRIKA_ID=98765432
```

**Vercel** — Settings → Environment Variables:
- Name: `NEXT_PUBLIC_YANDEX_METRIKA_ID`
- Value: `98765432`
- Environment: Production, Preview, Development

### Что уже настроено в коде

- Отслеживание просмотров страниц (SPA)
- Карта кликов
- Вебвизор
- Точный показатель отказов
- Отслеживание внешних ссылок

---

## 2. Google Analytics 4

### Шаг 1: Создание ресурса

1. Перейдите на [analytics.google.com](https://analytics.google.com)
2. Войдите через Google-аккаунт
3. **Администрирование** → **Создать ресурс**
4. Укажите:
   - **Название ресурса:** ASTRO by NDAUZH
   - **Часовой пояс:** (GMT+05:00) Алматы
   - **Валюта:** Тенге (KZT)
5. **Создать поток** → **Веб**
   - URL веб-сайта: `https://astrobyndauzh.com`
   - Имя потока: ASTRO

### Шаг 2: Получение ID

После создания потока вы получите **ID измерения** в формате `G-XXXXXXXXXX`. Скопируйте его.

### Шаг 3: Добавление в проект

**Локально** — в файл `.env.local`:
```
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX
```

**Vercel** — Settings → Environment Variables:
- Name: `NEXT_PUBLIC_GA_ID`
- Value: `G-XXXXXXXXXX`
- Environment: Production, Preview, Development

### Что уже настроено в коде

- Отслеживание просмотров страниц (SPA)
- Событие отправки заявки (конверсия) при успешной отправке формы
- Связка с Meta Pixel (если настроен)

---

## 3. Проверка работы

### Яндекс.Метрика

1. Откройте сайт в браузере
2. В [metrika.yandex.ru](https://metrika.yandex.ru) → ваш счётчик → **Отчёты**
3. Через 5–15 минут должны появиться визиты

### Google Analytics

1. Откройте сайт в браузере
2. В [analytics.google.com](https://analytics.google.com) → **Отчёты** → **В реальном времени**
3. Должен отображаться активный пользователь

---

## 4. Цели и конверсии (опционально)

### Яндекс.Метрика

- **Настройки** → **Цели** → **Добавить цель**
- Тип: «JavaScript-событие»
- Идентификатор: `lead_submit` (для отправки заявки)
- Для оплаты: `metodichka_pay_click`, `metodichka_purchase` (см. DEPLOYMENT.md)

### Google Analytics 4

- **Администрирование** → **События** — события отправки формы уже передаются
- **Администрирование** → **Конверсии** — отметьте нужное событие как конверсию

---

## Переменные в .env.local (итог)

```env
# Аналитика
NEXT_PUBLIC_YANDEX_METRIKA_ID=98765432
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX
```

После добавления переменных перезапустите dev-сервер (`npm run dev`) и задеплойте проект.
